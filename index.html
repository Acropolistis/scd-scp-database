<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SCD — SCP Database</title>
  <style>
    :root{
      --bg:#0b0f14;--panel:#121821;--muted:#9aa4b2;--text:#e6edf3;--accent:#6aa9ff;--card:#0f141b;--border:#1f2a36;
      --safe:#16a34a;--euclid:#eab308;--keter:#ef4444;--info:#60a5fa;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b0f14 0%,#0d131b 100%);color:var(--text);font:14px/1.45 system-ui,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    a{color:var(--accent);text-decoration:none}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;margin-bottom:18px}
    .logo{display:flex;align-items:center;gap:10px}
    .logo .dot{width:10px;height:10px;background:var(--accent);border-radius:50%}
    .title{font-weight:700;letter-spacing:.5px}
    .badge{border:1px solid var(--border);background:var(--panel);padding:4px 8px;border-radius:999px;color:var(--muted);font-size:12px}
    .toolbar{display:grid;grid-template-columns:1fr 140px 160px;gap:10px;margin:12px 0 18px}
    input,select{background:#0c1117;border:1px solid var(--border);color:var(--text);padding:10px 12px;border-radius:10px;outline:none}
    input::placeholder{color:#6b7785}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px;display:flex;flex-direction:column;gap:10px;box-shadow:0 6px 16px rgba(0,0,0,.25)}
    .card h3{margin:0;font-size:18px}
    .meta{display:flex;gap:8px;flex-wrap:wrap;color:var(--muted);font-size:12px}
    .pill{padding:3px 8px;border-radius:999px;font-weight:600;letter-spacing:.2px;color:#0b0f14}
    .safe{background:var(--safe)}.euclid{background:var(--euclid)}.keter{background:var(--keter)}
    .btn{display:inline-flex;justify-content:center;align-items:center;gap:8px;padding:9px 12px;border-radius:10px;border:1px solid var(--border);background:var(--panel);color:var(--text);cursor:pointer}
    .btn:hover{filter:brightness(1.1)}
    .btn.primary{background:var(--accent);color:#08111d;border-color:transparent;font-weight:700}
    .footer{color:var(--muted);text-align:center;margin:26px 0 18px}
    .hint{color:var(--muted);font-size:12px}

    dialog{width:min(820px,96vw);border:none;border-radius:18px;padding:0;background:var(--panel);color:var(--text);box-shadow:0 18px 60px rgba(0,0,0,.45)}
    dialog::backdrop{background:rgba(0,0,0,.62)}
    .modal-head{display:flex;justify-content:space-between;gap:8px;padding:16px 18px;border-bottom:1px solid var(--border)}
    .close{background:transparent;border:1px solid var(--border);color:var(--muted);border-radius:10px;padding:6px 10px;cursor:pointer}
    .modal-body{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;padding:18px}
    .section{background:#0c1117;border:1px solid var(--border);border-radius:14px;padding:14px}
    .section h4{margin:0 0 8px}
    .logs{display:flex;flex-direction:column;gap:10px;max-height:360px;overflow:auto}
    .log{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;font-size:13px}
    .label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.4px}
    .empty{border:1px dashed var(--border);color:var(--muted);text-align:center;padding:30px;border-radius:14px}
    .toolbar .hint{align-self:center;text-align:right}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"><span class="dot"></span><span class="title">SCD — SCP Database</span></div>
      <span class="badge">Alpha • MVP (add logs over time)</span>
    </header>

    <div class="toolbar">
      <input id="search" type="search" placeholder="Search by SCP #, title, or text…" />
      <select id="classFilter">
        <option value="">All Classes</option>
        <option value="Safe">Safe</option>
        <option value="Euclid">Euclid</option>
        <option value="Keter">Keter</option>
      </select>
      <select id="sort">
        <option value="recent">Sort: Recently Updated</option>
        <option value="alpha">Sort: A → Z</option>
        <option value="tests">Sort: Most Tests</option>
      </select>
    </div>

    <div class="grid" id="grid"></div>

    <p class="hint">Tip: Click any SCP to view containment, testing rules, and logs. Use the “Submit Test Log” link to feed your Google Form; add accepted logs back here over time.</p>

    <div class="footer">© Zetaworks SCD — made by Acropolistis. Theme: Safe <span class="pill safe">Safe</span> · Euclid <span class="pill euclid">Euclid</span> · Keter <span class="pill keter">Keter</span></div>
  </div>

  <dialog id="dialog">
    <div class="modal-head">
      <div>
        <div id="mClass" class="pill">Class</div>
        <h3 id="mTitle" style="margin:6px 0 0"></h3>
        <div id="mMeta" class="meta"></div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <a id="formLink" class="btn" target="_blank" rel="noopener">Submit Test Log</a>
        <button class="close" onclick="dlg.close()">Close</button>
      </div>
    </div>
    <div class="modal-body">
      <div class="section">
        <h4>Containment Procedures</h4>
        <div id="mContainment"></div>
        <div class="section" style="margin-top:12px">
          <h4>Testing Guidelines</h4>
          <div id="mGuidelines"></div>
        </div>
      </div>
      <div class="section">
        <h4>Test Logs</h4>
        <div id="mLogs" class="logs"></div>
      </div>
    </div>
  </dialog>

  <script>
    const DATA = [
      {
        id: "SCP-999",
        title: "The Tickle Monster",
        cls: "Safe",
        lastUpdated: "2025-08-01",
        containment: "Standard containment in a secure pen with enrichment items.",
        guidelines: [
          "No RCU required unless requested by Command.",
          "Junior Researcher+ may host. Maintain gentle handling.",
          "Follow general Class-D escort policy if CD is involved."
        ],
        logs: [
          { date: "2025-08-03", host: "Sr. Researcher Nova", summary: "Behavioral study; positive mood elevation observed in Class-D." }
        ]
      },
      {
        id: "SCP-173",
        title: "The Sculpture",
        cls: "Euclid",
        lastUpdated: "2025-07-28",
        containment: "Sealed chamber; line-of-sight maintained by at least two personnel during entry.",
        guidelines: [
          "Minimum 1 RCU present for any test.",
          "Researcher+ may host under Head Researcher+ supervision.",
          "Eye-contact callouts required; Class-D restraints mandatory."
        ],
        logs: []
      },
      {
        id: "SCP-106",
        title: "The Old Man",
        cls: "Keter",
        lastUpdated: "2025-07-15",
        containment: "Reinforced containment; corrosion checkpoints; rapid response on breach.",
        guidelines: [
          "Minimum 2 RCUs present.",
          "Head Researcher+ may host; Senior may co-host under supervision.",
          "Breach protocol prepared prior to test; evac routes briefed."
        ],
        logs: []
      }
    ];

    const GOOGLE_FORM_PREFILL_BASE = "https://docs.google.com/forms/d/e/FNVQz6zvZdrU2nKN6/viewform";
    const ENTRY_SCP_NUMBER = "entry.403004065";

    function buildFormURL(scpId){
      const u = new URL(GOOGLE_FORM_PREFILL_BASE);
      u.searchParams.set("usp","pp_url");
      u.searchParams.set(ENTRY_SCP_NUMBER, scpId);
      return u.toString();
    }

    const grid = document.getElementById('grid');
    const search = document.getElementById('search');
    const classFilter = document.getElementById('classFilter');
    const sortSel = document.getElementById('sort');
    const dlg = document.getElementById('dialog');

    function render(){
      const q = search.value.trim().toLowerCase();
      const f = classFilter.value;
      const sort = sortSel.value;
      let rows = DATA.map(r=>({...r}));
      if(f) rows = rows.filter(r=>r.cls===f);
      if(q){
        rows = rows.filter(r=>
          (r.id+" "+r.title+" "+r.containment+" "+r.guidelines.join(" ")+(r.logs||[]).map(l=>l.summary).join(" "))
          .toLowerCase().includes(q)
        );
      }
      if(sort==='alpha') rows.sort((a,b)=> (a.id+a.title).localeCompare(b.id+b.title));
      if(sort==='recent') rows.sort((a,b)=> (b.lastUpdated||'').localeCompare(a.lastUpdated||''));
      if(sort==='tests') rows.sort((a,b)=> (b.logs?.length||0)-(a.logs?.length||0));

      grid.innerHTML = rows.map(row=>cardHTML(row)).join('');
      document.querySelectorAll('.card').forEach(el=>{
        el.addEventListener('click',()=> openModal(el.dataset.id));
      })
    }

    function cardHTML(r){
      const pillClass = r.cls.toLowerCase();
      return `
        <div class="card" data-id="${r.id}">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
            <h3>${r.id}</h3>
            <span class="pill ${pillClass}">${r.cls}</span>
          </div>
          <div class="meta"><span>${r.title}</span>•<span>${r.logs?.length||0} test(s)</span>•<span>Updated ${r.lastUpdated||'—'}</span></div>
          <div class="hint">Click to open details</div>
        </div>`
    }

    function openModal(id){
      const r = DATA.find(x=>x.id===id);
      if(!r) return;
      const mClass = document.getElementById('mClass');
      mClass.textContent = r.cls;
      mClass.className = 'pill ' + r.cls.toLowerCase();
      document.getElementById('mTitle').textContent = `${r.id} — ${r.title}`;
      document.getElementById('mMeta').innerHTML = `<span class="label">Logs</span> ${r.logs?.length||0} • <span class="label">Last Updated</span> ${r.lastUpdated||'—'}`;
      document.getElementById('mContainment').textContent = r.containment||'—';
      document.getElementById('mGuidelines').innerHTML = (r.guidelines||[]).length? `<ul>${r.guidelines.map(g=>`<li>${g}</li>`).join('')}</ul>` : '<div class="empty">No guidelines yet.</div>';
      const logs = r.logs||[];
      const logsEl = document.getElementById('mLogs');
      logsEl.innerHTML = logs.length? logs.map(l=>`<div class="log"><div class="meta"><span>${l.date||''}</span> • <span>${l.host||''}</span></div><div>${l.summary||''}</div></div>`).join('') : '<div class="empty">No logs yet. Add via Google Form and update this entry later.</div>';
      document.getElementById('formLink').href = buildFormURL(r.id);
      dlg.showModal()
    }

    [search,classFilter,sortSel].forEach(el=> el.addEventListener('input', render));
    render();
  </script>
</body>
</html>
